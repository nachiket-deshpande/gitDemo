<apex:page docType="html-5.0" showHeader="false" sidebar="false"
    standardController="User" extensions="Profile_Personal_V1"
    standardStylesheets="false" action="{!QueryPage1}" id="PageID">
    <!--<apex:outputText value="{!subTabHTML}" escape="false" />-->
    <apex:stylesheet value="{!$Resource.acfCommStyles}"/>
    <style>
.empty-column-content {
    display: none;
}
.achorTagClass a {
 /* text-indent: -9999px; */
  height: 44px;
  line-height: 0 /* Collapse the original line */
}

.achorTagClass a::after {
   content: "Find";
  text-indent: 0;
  display: block;
  padding: 0px 0px 0px 29px;
 /* line-height: initial;*/
}
.relatedAnchorTag a{
   height: 44px;
  line-height: 0 
}
.relatedAnchorTag a::after{
 content: "Find";
  text-indent: 0;
  display: block;
  padding: 0px 0px 0px 29px;
  /*      content: "Find" !important;
    text-indent: 0;
    padding: 3px 40px;
    background: #8f4b42;
    color: #fff;
    text-decoration: none;
    border-radius: 3px;*/
}
.ContentColor{
    color: black;
    padding-top: 10px;
       margin-left: 19px;
}
.profile_page_wrapper .colSpan1 {
    width: 23%;
 /*   float: left;*/
}

.profile_page_wrapper .colSpan2 {
    width: 48%;
  /*  float: left;*/
}

.profile_page_wrapper .colSpan3 {
    width: 73%;
 /*   float: left;*/
}

.profile_page_wrapper .colSpan4 {
    width: 100%;
  /*  float: left;*/
}
.profile_page_margin{
    margin-left:5%;
}
.mobilebackgroundset
{
    border: 1px solid #b0b5b9 !important;
    padding: 10px !important;
    border-radius: 3px !important;
    border-width: 1px 1px 8px !important;
}
.backgroundColor2Column
{
    padding: 10px;
    border-radius: 3px;
    margin: 3px 0;
    min-height: 14px;
}
.Edit2Column{
    background: #fff;
    padding: 7px 10px;
    min-height: 20px;
}
.error{
    display:none;
}
.buttonClass {
   padding: 7px 40px;
    background: #8f4b42;
    color: #fff;
    text-decoration: none;
    border-radius: 3px;
 }
 .profile_page_wrapper .profile_data .profile_fullEdit a, .profile_page_wrapper .profile_data .ps_add{
  /*padding: 7px 40px;*/
  padding: 0px 0px 10px 72px;
  background: #8f4b42;
  color: #fff;
  text-decoration: none;
  border-radius: 3px;
  content : 'Find';
}
  .custPopup{
            background-color: white;
            z-index: 9999;
            left: 50%;
            padding:10px;
            position: absolute;
            width: 750px;
            margin-left: -380px;
            top:50px;
            -webkit-box-shadow: 1px 1px 17px 0px rgba(50, 50, 50, 0.75);
            -moz-box-shadow:1px 1px 17px 0px rgba(50, 50, 50, 0.75);
            box-shadow:1px 1px 17px 0px rgba(50, 50, 50, 0.75);
            border: solid 1px #dododo;
            border-radius:10px;
        }
        .popupBackground{
            background-color:black;
            opacity: 0.6;
            filter: alpha(opacity = 20);
            position: absolute;
            width: 100%;
            min-height: 200%;
            top: 0;
            left: 0;
            z-index: 9998;
        }
        .close-popup{  z-index: 9999;
          padding: 3px;
          float: right;
          position: absolute;
          top: 3px;
          right: 7px;}
  #assign-action-spinner-main {position: fixed;left: 0;top: 0;background-color:rgba(0,0,0,.6);height: 100%;width: 100%;z-index: 999;align: center;vertical-align: middle;}
       #assign-action-spinner-content {position: absolute; top: 50%;left: 50%;z-index: 1000;background-color: #F5FCFF;width: 204;height: 94; border-radius: 1em;border: 1px solid #CEECFF;padding: 20px 40px 20px 40px;margin-left: -116px;margin-top: -36px;}
       #assign-action-spinner-content img {width: 32;height: 32;align: center;vertical-align: middle;}
       #assign-action-spinner-content p {display: inline;font-size: 135%;font-weight: bold;}
</style>

<apex:pageMessages />
<apex:outputPanel rendered="{!!pageFailed}">
<apex:form id="frmSubsection">
<apex:pageMessages />
<apex:actionStatus id="theActionStatus" layout="block">
<apex:facet name="start">
<div id="assign-action-spinner-main">
<div id="assign-action-spinner-content">
<img src="/img/analytics/reportbuilder/icons/spinner32.gif" alt="Processing..." title="Processing..." /> 
<p>Processing...</p>
</div>
</div>
</apex:facet>
</apex:actionStatus>
     <div class="ContentColor"><apex:outputField value="{!communityWebContent.Page_Content__c}" rendered="{!showEditBtn}"/></div>
    <apex:actionFunction name="setDesktop" action="{!setDesktopMode}" reRender="frmSubsection" Status="theActionStatus" />
    <apex:actionFunction name="setMobile" action="{!setMobileMode}" reRender="frmSubsection" Status="theActionStatus" />
    <apex:actionFunction name="checkContactId" action="{!redirectOnBlankPage}" / >
<!--     <apex:actionFunction name="updateUserRecord" action="{!testMethodNew}" oncomplete="alert('{!relatedFullId}');" rerender="frmSubsection"/> -->
    <apex:actionFunction name="refreshDiv"
            reRender="pageBody, editPanel, editPanel2" />
        <div class="profile_page_wrapper">
            <apex:outputPanel id="upperButtonPanel">
                <div class="profile_buttons">
                    <apex:outPutPanel id="editPanel" rendered="{!showEditBtn}">
                        <apex:commandButton id="cbEdit" value="Edit"
                            rerender="pageBody, editPanel, editPanel2, lowerButtonPanel,
                                      upperButtonPanel"
                            action="{!EditSobjectRecord}" rendered="{!!isEditMode}" immediate="true"/>
                        <apex:commandButton id="cbSave" value="Save"
                            rerender="pageBody, editPanel, editPanel2, lowerButtonPanel,
                                      upperButtonPanel" onclick="confirm('{!show}','{!!isDisplayAdd}');"
                          rendered="{!isEditMode}" />
                        <apex:commandButton id="cbCancel" value="Cancel"
                            reRender="EditRender,pageBody, editPanel, editPanel2, lowerButtonPanel,
                                      upperButtonPanel"
                            action="{!cancel}" rendered="{!isEditMode}" />
                    </apex:outPutPanel>
                </div>
            </apex:outputPanel>


            <apex:outputpanel id="pageBody">
                <apex:repeat value="{!subSectionCustomSettings}" var="pageSection">
                    <apex:pageBlock title="">
                        <div class="profile_section">
                            <div class="profile_header">
                                {!pageSection['acfComm__Title__c']}
                                <!--<apex:outputPanel rendered="{!!isEditMode &&
                                pageSection['acfComm__Privacy_Field_API__c']!=null}">
                            <div class="profile_private"><apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][pageSection['acfComm__Privacy_Field_API__c']]}" /> Private</div>
                        </apex:outputPanel>-->
                                <apex:outputPanel rendered="{!isEditMode && pageSection['acfComm__Privacy_Field_API__c']!=null}">
                                    <div class="profile_private">
                                        <apex:inputField value="{!currentContact[pageSection['acfComm__Privacy_Field_API__c']]}" />
                                        Private
                                    </div>
                                </apex:outputPanel>
                            </div>
                            <div class="profile_helpText">{!pageSection['acfComm__Help_Text__c']}</div>
                            <div class="profile_data">
                                <!-- subsection -->
                                <apex:outputPanel rendered="{!pageSection['acfComm__Custom_Setting_Type__c']=='subsection'}">
                                    <!--<apex:repeat value="{!lstSubsectionCustomSetting}" var="subSectionObj">-->
                                    <apex:pageblockSection >
<!--                                         <apex:outputfield value="{!mapWebContent['!SUBSECTION_PUBLIC_PROFILE'].Page_Content__c}" label=""/> -->
                                    </apex:pageblockSection>
                                    <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                        var="subSectionObj">
                                        <div class="profile_section">
                                            <div class="profile_header">
                                                {!subSectionObj['acfComm__Title__c']}
                                                <!--<apex:outputPanel rendered="{!!isEditMode && subSectionObj['acfComm__Privacy_Field_API__c']!=null}">
                                            <div class="profile_private"><apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][subSectionObj['acfComm__Privacy_Field_API__c']]}" /> Private</div>
                                        </apex:outputPanel>-->
                                                <apex:outputPanel rendered="{!isEditMode && subSectionObj['acfComm__Privacy_Field_API__c']!=null}">
                                                    <div class="profile_private">
                                                        <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][subSectionObj['acfComm__Privacy_Field_API__c']]}" />
                                                        Private
                                                    </div>
                                                </apex:outputPanel>
                                            </div>
                                            <div class="profile_helpText">{!subSectionObj['acfComm__Help_Text__c']}</div><br/><br/>
                                            <div class="profile_data">
                                                <apex:outputPanel rendered="{!subSectionObj['acfComm__Custom_Setting_Type__c']=='2 column'}">
                                                    <apex:outputPanel rendered="{!pageSection['acfComm__Privacy_Field_API__c']==null || (pageSection['acfComm__Privacy_Field_API__c']!=null && sectionIdToObjMap[pageSection['Id']][0][pageSection['acfComm__Privacy_Field_API__c']]==false)}">
                                                        <apex:outputPanel rendered="{!subSectionObj['acfComm__Privacy_Field_API__c']==null || (subSectionObj['acfComm__Privacy_Field_API__c']==null!=null && sectionIdToObjMap[subSectionObj['Id']][0][subSectionObj['acfComm__Privacy_Field_API__c']]==false)}">
                                                            <apex:outputPanel rendered="{!!isEditMode}">
                                                            <apex:outputPanel rendered="{!!isMobileMode}">
                                                                <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                                    var="objField">

                                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                                        <div class="ps_fields colSpan1">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data">
                                                                                <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                                            </div>
                                                                        </div>
                                                                    </apex:outputpanel>
                                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                                        <div class="ps_fields colSpan2">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data">
                                                                                <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                                            </div>
                                                                        </div>
                                                                    </apex:outputpanel>
                                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                                        <div class="ps_fields colSpan3">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data">
                                                                                <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                                            </div>
                                                                        </div>
                                                                    </apex:outputpanel>
                                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                                        <div class="ps_fields colSpan4">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data">
                                                                                <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                                            </div>
                                                                        </div>
                                                                    </apex:outputpanel>
                                                                </apex:repeat>
                                                                </apex:outputPanel>
                                                                </apex:outputPanel>
                                                                <div class="clr">&nbsp;</div>
                                                                <!--  MOBILE VIEW -->
                                                                <apex:outputPanel rendered="{!isMobileMode}">
                                                                <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                                    var="objField">

                                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                                    <div class="ps_fields ps_Mobile">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data">
                                                                                <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                                            </div>
                                                                    </div>
                                                                    </apex:outputpanel>
                                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                                    <div class="ps_fields ps_Mobile">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data">
                                                                                <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                                            </div>
                                                                    </div>
                                                                    </apex:outputpanel>
                                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                                    <div class="ps_fields ps_Mobile">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data">
                                                                                <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                                            </div>
                                                                    </div>
                                                                    </apex:outputpanel>
                                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                                    <div class="ps_fields ps_Mobile">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data">
                                                                                <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                                            </div>
                                                                    </div>
                                                                    </apex:outputpanel>
                                                                </apex:repeat>
<!--                                                                 </apex:outputPanel> -->
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    
                                                    <apex:outputPanel rendered="{!isEditMode}">
                                                     <apex:outputPanel rendered="{!!isMobileMode}">
                                                        <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                            var="objField">
                                                            <apex:outputPanel rendered="{!!objField.Read_Only__c}">
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                                     <div class="ps_fields colSpan1">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                            </apex:outputPanel> 
                                                                        </div>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                                     <div class="ps_fields colSpan2">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                                      <div class="ps_fields colSpan3">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                                  <div class="ps_fields colSpan4">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                        </div>
                                                                </apex:outputpanel>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!objField.Read_Only__c}">
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                                       <div class="ps_fields colSpan1">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data">
                                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                                  <div class="ps_fields colSpan2">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data">
                                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                                   <div class="ps_fields colSpan3">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data">
                                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                                  <div class="ps_fields colSpan4">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data">
                                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                        </div>
                                                                </apex:outputpanel>
                                                            </apex:outputPanel>
                                                        </apex:repeat>
                                                        </apex:outputPanel>
                                                        
                                                        <!--  MOBILE VIEW -->
                                                        <apex:outputpanel rendered="{!isMobileMode}">
                                                        <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                            var="objField">
                                                            <apex:outputPanel rendered="{!!objField.Read_Only__c}">
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                            </apex:outputPanel> 
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                </apex:outputpanel>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!objField.Read_Only__c}">
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data">
                                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data">
                                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data">
                                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                        </div>
                                                                        <div class="ps_data">
                                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                                        </div>
                                                                        <div class="ps_private">
                                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private
                                                                                </apex:outputPanel>
                                                                        </div>
                                                                </apex:outputpanel>
                                                            </apex:outputPanel>
                                                        </apex:repeat>
                                                        </apex:outputpanel>
                                                        </apex:outputPanel>
                                                </apex:outputPanel>

                                                   <!-- preferences -->
                                <apex:outputPanel rendered="{!subSectionObj['acfComm__Custom_Setting_Type__c']=='preferences'}">
                                    <apex:pageblockSection >
<!--                                         <apex:outputfield value="{!mapWebContent['Two Column public Profile'].Page_Content__c}" /> -->
                                    </apex:pageblockSection>
                                    <apex:outputPanel rendered="{!subSectionObj['acfComm__Privacy_Field_API__c']==null || (subSectionObj['acfComm__Privacy_Field_API__c']!=null && sectionIdToObjMap[subSectionObj['Id']][0][subSectionObj['acfComm__Privacy_Field_API__c']]==false)}">
                                        <apex:outputPanel rendered="{!!isEditMode}">

                                            <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                var="objField">
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                    <div class="ps_fieldsPref colSpan1">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                    <div class="ps_fieldsPref colSpan2">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                    <div class="ps_fieldsPref colSpan3">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                    <div class="ps_fieldsPref colSpan4">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>

                                            </apex:repeat>

                                            <div class="clr">&nbsp;</div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!isEditMode}">
                                        <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                            var="objField">
                                            <apex:outputPanel rendered="{!!objField.Read_Only__c}">
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                    <div class="ps_fieldsPref colSpan1">
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                    <div class="ps_fieldsPref colSpan2">
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                    <div class="ps_fieldsPref colSpan3">
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                    <div class="ps_fieldsPref colSpan4">
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>

                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!objField.Read_Only__c}">
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                    <div class="ps_fieldsPref colSpan1">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                    <div class="ps_fieldsPref colSpan2">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                    <div class="ps_fieldsPref colSpan3">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                    <div class="ps_fieldsPref colSpan4">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[subSectionObj['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                            </apex:outputPanel>
                                        </apex:repeat>
                                        <div class="clr">&nbsp;</div>
                                    </apex:outputPanel>
                                </apex:outputPanel>

                                                <!-- related list compact -->
                                                <apex:outputPanel rendered="{!subSectionObj['acfComm__Custom_Setting_Type__c']=='related list compact'}">
                                                    related list compact
                                                    <apex:pageblockSection >
<!--                                                         <apex:outputfield value="{!mapWebContent['Related List Compact Public Profile'].Page_Content__c}" label=""/> -->
                                                    </apex:pageblockSection>
                                                    <apex:outputPanel rendered="{!!isEditMode}">
                                                        <apex:outputPanel rendered="{!subSectionObj['acfComm__Privacy_Field_API__c']==null || (subSectionObj['acfComm__Privacy_Field_API__c']!=null && currentContact[pageSection['acfComm__Privacy_Field_API__c']]==false)}">
                                                            <apex:pageBlockTable value="{!sectionIdToObjMap[subSectionObj['Id']]}"
                                                                var="pbtObj">
                                                                <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                                    var="objField">
                                                                    <apex:column value="{!pbtObj[objField.acfComm__Field_API_Name__c]}">
                                                                        <apex:facet name="header">{!objField.acfComm__Field_Name__c}</apex:facet>

                                                                    </apex:column>
                                                                </apex:repeat>
                                                            </apex:pageBlockTable>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!isEditMode}">
                                                        <apex:pageBlockTable value="{!sectionIdToObjMap[subSectionObj['Id']]}"
                                                            var="pbtObj">
                                                            <apex:column >
                                                                <apex:commandLink value="Delete"
                                                                    action="{!deleteRelatedList}"
                                                                    rendered="{!subSectionObj['acfComm__Related_List_Read_Only_API__c']==null || (subSectionObj['acfComm__Related_List_Read_Only_API__c']!=null && pbtObj[subSectionObj['acfComm__Related_List_Read_Only_API__c']]==false)}">
                                                                    <apex:param name="realtedListObjId"
                                                                        value="{!pbtObj['Id']}" assignTo="{!realtedListObjId}" />
                                                                </apex:commandLink>
                                                                <apex:facet name="footer">
                                                                    <apex:commandLink value="Add"
                                                                        action="{!saveSobjectRecordToList}"
                                                                        styleClass="ps_add">
                                                                        <apex:param name="pageSectionId"
                                                                            value="{!subSectionObj['Id']}"
                                                                            assignTo="{!pageSectionId}" />
                                                                    </apex:commandLink>
                                                                </apex:facet>
                                                            </apex:column>
                                                            <apex:column value="{!pbtObj[subSectionObj['acfComm__Related_List_Privacy_API__c']]}"
                                                                rendered="{!subSectionObj['acfComm__Related_List_Privacy_API__c']!=null}">
                                                                <apex:facet name="header">Private</apex:facet>
                                                                <apex:facet name="footer">
                                                                    <apex:inputField value="{!sectionIdToRelatedListObjectMap[subSectionObj['Id']][subSectionObj['acfComm__Related_List_Privacy_API__c']]}" />
                                                                </apex:facet>
                                                            </apex:column>
                                                            <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                                var="objField">
                                                                <apex:column value="{!pbtObj[objField.acfComm__Field_API_Name__c]}">
                                                                    <apex:facet name="header">{!objField.acfComm__Field_Name__c}</apex:facet>
                                                                    <apex:facet name="footer">
                                                                        <apex:inputField required="false" value="{!sectionIdToRelatedListObjectMap[subSectionObj['Id']][objField.acfComm__Field_API_Name__c]}" />
                                                                    </apex:facet>
                                                                </apex:column>
                                                            </apex:repeat>
                                                        </apex:pageBlockTable>
                                                    </apex:outputPanel>
                                                </apex:outputPanel>

                                                <!-- related list full -->
                                                <apex:outputPanel rendered="{!subSectionObj['acfComm__Custom_Setting_Type__c']=='related list full'}">
                                                    <apex:pageblockSection >
<!--                                                         <apex:outputfield value="{!mapWebContent['Related list Full Public Profile'].Page_Content__c}" label=""/> -->
                                                    </apex:pageblockSection>
                                                    <apex:outputPanel rendered="{!!isEditMode}">
                                                        <apex:outputPanel rendered="{!pageSection['acfComm__Privacy_Field_API__c']==null || (pageSection['acfComm__Privacy_Field_API__c']!=null && currentContact[pageSection['acfComm__Privacy_Field_API__c']]==false)}">
                                                            <apex:pageBlockTable value="{!sectionIdToObjMap[subSectionObj['Id']]}"
                                                                var="pbtObj">
                                                                <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                                    var="objField">
                                                                    <apex:column value="{!pbtObj[objField.acfComm__Field_API_Name__c]}"
                                                                        rendered="{!objField.acfComm__Read_Mode__c==true}">
                                                                        <apex:facet name="header">{!objField.acfComm__Field_Name__c}</apex:facet>
                                                                    </apex:column>
                                                                </apex:repeat>
                                                            </apex:pageBlockTable>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!isEditMode}">
                                                        <!--<apex:variable var="obj3" value="{!sectionIdToObjMap[pageSection['Id']][0]}" />-->
                                                        <apex:pageBlockTable value="{!sectionIdToObjMap[subSectionObj['Id']]}"
                                                            var="pbtObj">
                                                            <apex:column >
                                                                <apex:commandLink value="Delete"
                                                                    action="{!deleteRelatedList}"
                                                                    rendered="{!subSectionObj['acfComm__Related_List_Read_Only_API__c']==null || (subSectionObj['acfComm__Related_List_Read_Only_API__c']!=null && pbtObj[subSectionObj['acfComm__Related_List_Read_Only_API__c']]==false)}">
                                                                    <apex:param name="realtedListObjId"
                                                                        value="{!pbtObj['Id']}" assignTo="{!realtedListObjId}" />
                                                                </apex:commandLink>
                                                            </apex:column>
                                                            <apex:column value="{!pbtObj[subSectionObj['acfComm__Related_List_Privacy_API__c']]}"
                                                                rendered="{!subSectionObj['acfComm__Related_List_Privacy_API__c']!=null}">
                                                                <apex:facet name="header">Private</apex:facet>
                                                            </apex:column>
                                                            <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                                var="objField">
                                                                <apex:column value="{!pbtObj[objField.acfComm__Field_API_Name__c]}"
                                                                    rendered="{!objField.acfComm__Read_Mode__c==true}">
                                                                    <apex:facet name="header">{!objField.acfComm__Field_Name__c}</apex:facet>
                                                                </apex:column>
                                                            </apex:repeat>
                                                        </apex:pageBlockTable>
                                                        <div class="profile_fullEdit">
                                                            <div class="ps_addNew">Add New</div>
                                                            <apex:outputPanel >
                                                                <apex:outputPanel rendered="{!subSectionObj['acfComm__Related_List_Privacy_API__c']!=null}">
                                                                    <div class="ps_fields">
                                                                        <div class="ps_label">
                                                                            <apex:outputLabel value="Private" />
                                                                        </div>
                                                                        <div class="ps_data ps_edit">
                                                                            <apex:inputField value="{!sectionIdToRelatedListObjectMap[subSectionObj['Id']][subSectionObj['acfComm__Related_List_Privacy_API__c']]}" />
                                                                        </div>
                                                                    </div>
                                                                </apex:outputPanel>
                                                                <apex:repeat value="{!sectionIdToFieldsMap[subSectionObj['Id']]}"
                                                                    var="objField">
                                                                    <apex:outputPanel rendered="{!objField.acfComm__Edit_Mode__c==true}">
                                                                        <div class="ps_fields">
                                                                            <div class="ps_label">
                                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                            </div>
                                                                            <div class="ps_data ps_edit">
                                                                                <apex:inputField required="false" value="{!sectionIdToRelatedListObjectMap[subSectionObj['Id']][objField.acfComm__Field_API_Name__c]}" />
                                                                                <!--<apex:inputfield value="{!sectionIdToRelatedListObjectMap[pageSection['Id']][objField.acfComm__Privacy_Field_API__c]}" label="" rendered="{!objField.acfComm__Privacy_Field_API__c!=null}"/>-->
                                                                            </div>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </apex:repeat>
                                                                <div class="clr">&nbsp;</div>
                                                            </apex:outputPanel>
                                                            <apex:commandLink value="Add"
                                                                action="{!saveSobjectRecordToList}">
                                                                <apex:param name="pageSectionId"
                                                                    value="{!subSectionObj['Id']}"
                                                                    assignTo="{!pageSectionId}" />
                                                            </apex:commandLink>
                                                        </div>
                                                        <!--<apex:commandLink value="Create" action="{!saveSobjectRecordToListFull}" reRender="pageBody">
                                                         <apex:param name="pageSectionId" value="{'TEST'}" />
                                                    </apex:commandLink>-->
                                                    </apex:outputPanel>
                                                </apex:outputPanel>

                                            </div>
                                        </div>
                                    </apex:repeat>
                                </apex:outputPanel>

                                <!-- 2 column -->
                                <apex:outputPanel rendered="{!pageSection['acfComm__Custom_Setting_Type__c']=='2 column'}">
                                   
                                    <apex:pageblockSection >
<!--                                         <apex:outputfield value="{!mapWebContent['Two Column public Profile'].Page_Content__c}" label="" /> -->
                                    </apex:pageblockSection>
                                    
                                  <apex:outputPanel rendered="{!pageSection['acfComm__Privacy_Field_API__c']==null || (pageSection['acfComm__Privacy_Field_API__c']!=null && sectionIdToObjMap[pageSection['Id']][0][pageSection['acfComm__Privacy_Field_API__c']]==false)}">
                                        <apex:outputPanel rendered="{!!isEditMode}">
                                            <apex:outputPanel rendered="{!!isMobileMode}">
                                                <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}" var="objField">
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                        <div class="ps_fields colSpan1">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="ps_data">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                            </div>
                                                        </div>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                        <div class="ps_fields colSpan2">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="ps_data">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                            </div>
                                                        </div>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                        <div class="ps_fields colSpan3">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="ps_data">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                            </div>
                                                        </div>
                                                    </apex:outputpanel>
                                                    
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                        <div class="ps_fields colSpan4">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="ps_data">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                    rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                            </div>
                                                        </div>
                                                    </apex:outputpanel>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                            <div class="clr">&nbsp;</div>
                                            <!--- Mobile View-->
                                            <apex:outputPanel rendered="{!isMobileMode}">
                                                <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                    var="objField">
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                             <div>
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <apex:outputpanel rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}">
                                                                <div class="backgroundColor2Column">
                                                                    <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"/>
                                                                </div>
                                                            </apex:outputpanel>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                            <div >
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <apex:outputpanel rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}">
                                                            <div class="backgroundColor2Column">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"/>
                                                            </div>
                                                            </apex:outputpanel>
                                                    </apex:outputpanel>
                                                    
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <apex:outputpanel rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}">
                                                                <div  class="backgroundColor2Column">
                                                                    <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"/>
                                                                </div>
                                                            </apex:outputpanel>
                                                    </apex:outputpanel>
                                                    
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                            <div>
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <apex:outputpanel rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}">
                                                                <div  class="backgroundColor2Column">
                                                                    <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"/>
                                                                </div>
                                                            </apex:outputpanel>
                                                    </apex:outputpanel>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                    
                                    <apex:outputPanel rendered="{!isEditMode}">
                                    <apex:outputPanel rendered="{!!isMobileMode}">
                                        <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                            var="objField">
                                            <apex:outputPanel rendered="{!!objField.Read_Only__c}">
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                    <div class="ps_fields colSpan1">
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                    <div class="ps_fields colSpan2">
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                    <div class="ps_fields colSpan3">
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                    <div class="ps_fields colSpan4">
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>

                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!objField.Read_Only__c}">
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                    <div class="ps_fields colSpan1">
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                    <div class="ps_fields colSpan2">
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                    <div class="ps_fields colSpan3">
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                    <div class="ps_fields colSpan4">
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                            </apex:outputPanel>
                                        </apex:repeat>
                                        </apex:outputPanel>
                                        <div class="clr">&nbsp;</div>
                                        <!--- Mobile View-->
                                        <apex:outputpanel rendered="{!isMobileMode}">
                                            <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                var="objField">
                                                <apex:outputPanel rendered="{!!objField.Read_Only__c}">
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                            <div>
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="Edit2Column">
                                                                <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                            </div>
                                                            <div class="ps_private">
                                                                <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                    <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                            </div>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="Edit2Column">
                                                                <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                            </div>
                                                            <div class="ps_private">
                                                                <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                    <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                            </div>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="Edit2Column">
                                                                <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                            </div>
                                                            <div class="ps_private">
                                                                <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                    <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                            </div>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="Edit2Column">
                                                                <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                            </div>
                                                            <div class="ps_private">
                                                                <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                    <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                            </div>
                                                    </apex:outputpanel>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!objField.Read_Only__c}">
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="backgroundColor2Column">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                            </div>
                                                            <div class="ps_private">
                                                                <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                    <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                            </div>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="backgroundColor2Column">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                            </div>
                                                            <div class="ps_private">
                                                                <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                    <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                            </div>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="backgroundColor2Column">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                            </div>
                                                            <div class="ps_private">
                                                                <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                    <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                            </div>
                                                    </apex:outputpanel>
                                                    <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                            <div class="ps_label">
                                                                <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                            </div>
                                                            <div class="backgroundColor2Column">
                                                                <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                            </div>
                                                            <div class="ps_private">
                                                                <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                    <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                            </div>
                                                    </apex:outputpanel>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </apex:outputpanel>
                                        
                                    </apex:outputPanel>
                                </apex:outputPanel>

                                <!-- preferences -->
                                <apex:outputPanel rendered="{!pageSection['acfComm__Custom_Setting_Type__c']=='preferences'}">
                                    <apex:pageblockSection >
<!--                                         <apex:outputfield value="{!mapWebContent['Two Column public Profile'].Page_Content__c}" /> -->
                                    </apex:pageblockSection>
                                    <apex:outputPanel rendered="{!pageSection['acfComm__Privacy_Field_API__c']==null || (pageSection['acfComm__Privacy_Field_API__c']!=null && sectionIdToObjMap[pageSection['Id']][0][pageSection['acfComm__Privacy_Field_API__c']]==false)}">
                                        <apex:outputPanel rendered="{!!isEditMode}">

                                            <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                var="objField">
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                    <div class="ps_fieldsPref colSpan1">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                    <div class="ps_fieldsPref colSpan2">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                    <div class="ps_fieldsPref colSpan3">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                    <div class="ps_fieldsPref colSpan4">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}"
                                                                rendered="{!objField.acfComm__Privacy_Field_API__c==null || (objField.acfComm__Privacy_Field_API__c!=null && sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]==false)}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>

                                            </apex:repeat>

                                            <div class="clr">&nbsp;</div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!isEditMode}">
                                        <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                            var="objField">
                                            <apex:outputPanel rendered="{!!objField.Read_Only__c}">
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                    <div class="ps_fieldsPref colSpan1">
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                    <div class="ps_fieldsPref colSpan2">
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                    <div class="ps_fieldsPref colSpan3">
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                    <div class="ps_fieldsPref colSpan4">
                                                        <div class="ps_data ps_edit">
                                                            <apex:inputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>

                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!objField.Read_Only__c}">
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="1" || objField.acfComm__Column_Span__c==''}">
                                                    <div class="ps_fieldsPref colSpan1">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="2"}">
                                                    <div class="ps_fieldsPref colSpan2">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="3"}">
                                                    <div class="ps_fieldsPref colSpan3">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                                <apex:outputpanel rendered="{!objField.acfComm__Column_Span__c =="4"}">
                                                    <div class="ps_fieldsPref colSpan4">
                                                        <div class="ps_data">
                                                            <apex:outputField value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Field_API_Name__c]}" />
                                                        </div>
                                                        <div class="ps_label">
                                                            <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                        </div>
                                                        <div class="ps_private">
                                                            <apex:outputPanel rendered="{!objField.acfComm__Privacy_Field_API__c!=null}">
                                                                <apex:inputfield value="{!sectionIdToObjMap[pageSection['Id']][0][objField.acfComm__Privacy_Field_API__c]}" /> Private</apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputpanel>
                                            </apex:outputPanel>
                                        </apex:repeat>
                                        <div class="clr">&nbsp;</div>
                                    </apex:outputPanel>
                                </apex:outputPanel>
                                
                            <!-- related list compact -->
                                <apex:outputPanel rendered="{!pageSection['acfComm__Custom_Setting_Type__c']=='related list compact'}">
                                   <apex:pageblockSection >
<!--                                         <apex:outputfield value="{!mapWebContent['Related List Compact Public Profile'].Page_Content__c}" label=""/> -->
                                    </apex:pageblockSection>
                                    <!-- Output fields-->
                                    <apex:outputPanel rendered="{!!isEditMode}">
                                        <!--- Desktop view -->
                                      <apex:outputPanel rendered="{!pageSection['acfComm__Privacy_Field_API__c']==null ||
                                                                    (pageSection['acfComm__Privacy_Field_API__c']!=null  &&
                                                                    currentContact[pageSection['acfComm__Privacy_Field_API__c']]==false)}" id="theDesktopPanel">
                                            <apex:pageBlockTable value="{!sectionIdToObjMap[pageSection['Id']]}" var="pbtObj">
                                                <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                    var="objField">
                                                    <apex:outputText value="{!objField}" />
                                                    <apex:column value="{!pbtObj[objField.acfComm__Field_API_Name__c]}"
                                                        rendered="{!objField.acfComm__Read_Mode__c==true}">
                                                        <apex:facet name="header">{!objField.acfComm__Field_Name__c}</apex:facet>
                                                    </apex:column>
                                                </apex:repeat>
                                                <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                    var="objField">
                                                    
                                                    <apex:repeat value="{!lstWrapper}" var="objWrapper">
                                                        <apex:outputpanel rendered="{!If(objWrapper.FieldApiName == objField.acfComm__Field_Name__c,true,false)}">
                                                        <apex:selectlist value="{!objWrapper.SelectedValue}"
                                                            rendered="{!If(objWrapper.FieldApiName == objField.acfComm__Field_Name__c,true,false)}">
                                                            <apex:selectOptions value="{!objWrapper.lstSelectOption}" />
                                                        </apex:selectlist>
                                                         </apex:outputpanel>
                                                    </apex:repeat>
                                                </apex:repeat>
                                            </apex:pageBlockTable>  
                                        </apex:outputPanel>
                                    </apex:outputPanel>

                                       <apex:outputPanel id="compEditModeId" rendered="{!isEditMode}">                                    
                                                <apex:pageBlockTable id="pbtable1" value="{!sectionIdToObjMap[pageSection['Id']]}" var="pbtObj">
                                                      <apex:column rendered="{!pageSection['acfComm__Edit__c'] || pageSection['acfComm__Delete__c'] 
                                                                                                    ||  pageSection['acfComm__Create__c']}">
                                                <span class="profile_page_margin">
                                                <apex:commandLink value="Edit"
                                                                  action="{!editRelatedListCompact}" 
                                                                  rendered="{!pbtObj['Id'] != relatedListCompEditId && pageSection['acfComm__Edit__c'] && mapEditableFields[pbtObj['Id']] == false}" immediate="true">
                                                     <apex:param name="relatedListCompEditId"
                                                            value="{!pbtObj['Id']}" assignTo="{!relatedListCompEditId}" />
                                                </apex:commandLink>
                                                </span>
                                                
                                                <span class="profile_page_margin">
                                                <apex:commandLink value="Delete"
                                                    action="{!deleteRelatedList}"
                                                    rendered="{!pageSection['acfComm__Delete__c'] && mapEditableFields[pbtObj['Id']] == false }" immediate="true">
                                                    <apex:param name="realtedListObjId" value="{!pbtObj['Id']}"
                                                        assignTo="{!realtedListObjId}" />
                                                </apex:commandLink>
                                                </span>
                                                
<!--                                                 <span class="profile_page_margin"> -->
<!--                                                     <apex:commandLink value="Update" rerender="frmSubsection" action="{!UpdateRelatedFullRecord}" rendered="{!mapEditableFields[pbtObj['Id']]}"> -->
<!--                                                         <apex:param name="relFullId" value="{!pbtObj['Id']}" assignTo="{!relatedFullId}" /> -->
<!--                                                     </apex:commandLink> -->
<!--                                                 </span> -->
                                                
                                               
                                                 <apex:facet name="footer">
<!--                                                       <button class="buttonClass" type="button"  onclick="validateIsBlankCompact1(this, '{!pageSection['Id']}')">Add</button> -->
                                                <apex:outputpanel >
                                                         <apex:commandButton value="Add" onclick="validateIsBlankCompact1(this, '{!pageSection['Id']}')" status="theActionStatus" rendered="{!isDisplayAdd}" styleClass="buttonClass updateBtnRelatedFull" style="width: 113px;height: 32px;" reRender="frmSubsection"/>
<!--                                                          <apex:commandButton value="Update" onclick="validateIsBlankFullUpdateCompact('{!pbtObj.id}')"  oncomplete="alert('{!pbtObj.id}');" status="theActionStatus" styleClass="buttonClass" rendered="{!!isDisplayAdd}" style="width: 113px;height: 32px;"/> -->
                                                              <apex:commandButton value="Update" onclick="validateIsBlankFullUpdateCompact()" status="theActionStatus" styleClass="buttonClass updateBtnRelatedFull" rendered="{!!isDisplayAdd}" style="width: 113px;height: 32px;" reRender="frmSubsection"/>
                                                </apex:outputpanel>
                                                </apex:facet> 
                                              
                                                 
                                            </apex:column>
                                            
<!--                                              <apex:repeat value="{!sectionIdToObjMap[pageSection['Id']]}" var="pbtObj"> -->
                                            <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                var="objField" >   
                                                <apex:column > 
<!--                                                    <apex:inputField required="false" value="{!pbtObj[objField.acfComm__Field_API_Name__c]}" rendered="{!mapEditableFields[pbtObj['Id']]}"/> -->
<!--                                                          <apex:inputField required="false" value="{!pbtObj[objField.acfComm__Field_API_Name__c]}"  -->
<!--                                                                 rendered="{!pbtObj['Id'] == realtedListEditObjId && !isDisplayAdd}" styleClass="tobeCheckd"/> -->
                                                        
                                                    <apex:outputField value="{!pbtObj[objField.acfComm__Field_API_Name__c]}"/>
                                                    <apex:facet name="header">{!objField.acfComm__Field_Name__c}</apex:facet>
                                                         <apex:facet name="footer">
                                                                    <apex:outputpanel >
<!--                                                                     {!pbtObj[objField.acfComm__Field_API_Name__c]}--   {!objField.acfComm__Field_API_Name__c} -- {!pbtObj} -->
                                                                                  <apex:inputField required="false" value="{!sectionIdToRelatedListObjectMap[pageSection['Id']][objField.acfComm__Field_API_Name__c]}"
                                                                                   rendered="{!pageSection['acfComm__Create__c'] && pageSection['acfComm__Read_Only__c']==false && isDisplayAdd}" styleClass="tobeCheckd"/>
                                                                                   
<!--                                                                                    <apex:inputField required="false" value="{!sectionIdToRelatedListObjectMap[pageSection['Id']][objField.acfComm__Field_API_Name__c]}"  -->
<!--                                                                                    rendered="{!pageSection['acfComm__Create__c'] && pageSection['acfComm__Read_Only__c']==false && !isDisplayAdd}" styleClass="tobeCheckd"/> -->
<!--                                                                                    <apex:inputText value="{!pbtObj[realtedListEditObjId]}"/> -->
                                                                                   <apex:inputField value="{!objStudent[objField.acfComm__Field_API_Name__c]}" rendered="{!!isDisplayAdd}" styleClass="tobeCheckd"/>
<!--                                                                                    <apex:outputLabel value="{!pbtObj[objField.acfComm__Field_API_Name__c]}"  rendered="{!pbtObj['Id'] == realtedListEditObjId && !isDisplayAdd}" /> -->
<!--                                                                                      <apex:inputField required="false" value="{!pbtObj[objField.acfComm__Field_API_Name__c]}" rendered="{!pbtObj['Id'] == realtedListEditObjId && !isDisplayAdd}"  -->
<!--                                                                                      styleClass="tobeCheckd"/> -->
                                                                              </apex:outputpanel>     
                                                     </apex:facet>
                                                     </apex:column>
<!--                                                      <apex:column > -->
<!--                                                      <apex:facet name="footer"> -->
<!--                                                          <apex:inputText value="{!objStudent[objField.acfComm__Field_API_Name__c]}" rendered="{!!isDisplayAdd}" styleClass="tobeCheckd"/> -->
<!--                                                      </apex:facet> -->
<!--                                                      </apex:column> -->
                                            </apex:repeat>
                                        </apex:pageBlockTable>
                                         <apex:outputpanel id="name-error" styleClass="error" style="color: #8f4b42;">At least one field must have a value</apex:outputpanel>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        
                                <!-- related list full -->
                                <apex:outputPanel rendered="{!pageSection['acfComm__Custom_Setting_Type__c']=='related list full'}">
                                    <apex:pageblockSection >
<!--                                         <apex:outputfield value="{!mapWebContent['Related list Full Public Profile'].Page_Content__c}" label=""/> -->
                                    </apex:pageblockSection>
                                     <!-- Output fields-->
                                    <apex:outputPanel rendered="{!!isEditMode}">
                                        <apex:outputPanel rendered="{!pageSection['acfComm__Privacy_Field_API__c']==null ||
                                                                    (pageSection['acfComm__Privacy_Field_API__c']!=null &&
                                                                    currentContact[pageSection['acfComm__Privacy_Field_API__c']]==false)}">
                                            <apex:pageBlockTable value="{!sectionIdToObjMap[pageSection['Id']]}" var="pbtObj">
                                                <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                    var="objField">

                                                    <apex:column value="{!pbtObj[objField.acfComm__Field_API_Name__c]}"
                                                        rendered="{!objField.acfComm__Read_Mode__c==true}">
                                                        <apex:facet name="header">{!objField.acfComm__Field_Name__c}</apex:facet>
                                                    </apex:column>
                                                </apex:repeat>
                                                <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                    var="objField">
                                                    <apex:repeat value="{!lstWrapper}" var="objWrapper">
                                                       {!objField.acfComm__Field_Name__c}
                                                       <apex:outputpanel rendered="{!If(objWrapper.FieldApiName == objField.acfComm__Field_Name__c,true,false)}">
                                                        <apex:selectlist value="{!objWrapper.SelectedValue}"
                                                            rendered="{!If(objWrapper.FieldApiName == objField.acfComm__Field_Name__c,true,false)}">
                                                            <apex:selectOptions value="{!objWrapper.lstSelectOption}" />
                                                        </apex:selectlist>
                                                      </apex:outputpanel>
                                                    </apex:repeat>
                                                </apex:repeat>
                                            </apex:pageBlockTable>
                                        </apex:outputPanel>
                                        </apex:outputPanel>
                                    <!-- Input fields-->
<!--                                     <apex:actionFunction action="{!editRelatedList}" name="editRelatedList" rerender="showUpdatePanel"/> -->
                                    <apex:outputPanel rendered="{!isEditMode}">
                                    
                                        <!--<apex:variable var="obj3" value="{!sectionIdToObjMap[pageSection['Id']][0]}" />-->
                                        <apex:pageBlockTable id="pbtable" value="{!sectionIdToObjMap[pageSection['Id']]}" var="pbtObj">
                                            <apex:column rendered="{!pageSection['acfComm__Edit__c'] || pageSection['acfComm__Delete__c']}">
                                                <span class="profile_page_margin">
                                                <apex:commandLink value="Edit" id="EditRender"
                                                             action="{!InvokeShow}" immediate="true" rendered="{!pbtObj['Id'] != realtedListEditObjId && 
                                                                                                                                                pageSection['acfComm__Edit__c'] && mapEditableFields[pbtObj['Id']] == false }">
                                                     <apex:param name="realtedListEditObjId"
                                                            value="{!pbtObj['Id']}" assignTo="{!realtedListEditObjId}" />
                                                </apex:commandLink>

                                                </span>
                                                <span class="profile_page_margin"> 
                                                    <apex:commandLink value="Delete" action="{!deleteRelatedList}" immediate="true" rendered="{!pageSection['acfComm__Delete__c'] && mapEditableFields[pbtObj['Id']] == false }">
<!--                                                         rendered="{!pageSection['acfComm__Delete__c'] && mapEditableFields[pbtObj['Id']] == false }" immediate="true"> -->
    <!--                                                     rendered="{!(pageSection['acfComm__Read_Only__c']==false) && (pageSection['acfComm__Related_List_Read_Only_API__c']==null || (pageSection['acfComm__Related_List_Read_Only_API__c']!=null && pbtObj[pageSection['acfComm__Related_List_Read_Only_API__c']]==false))}"> -->
                                                        <apex:param name="realtedListObjId" value="{!pbtObj['Id']}"
                                                            assignTo="{!realtedListObjId}" />
                                                    </apex:commandLink>
                                                    </span>
<!--                                                     <span class="profile_page_margin"> -->
<!--                                                     <apex:commandLink value="Update" rerender="frmSubsection" action="{!UpdateRelatedFullRecord}" -->
<!--                                                          rendered="{!mapEditableFields[pbtObj['Id']]}"> -->
<!--                                                     <apex:param name="relFullId" value="{!pbtObj['Id']}" -->
<!--                                                             assignTo="{!relatedFullId}" /> -->
<!--                                                     </apex:commandLink> -->
<!--                                                 </span> -->
                                            </apex:column>
                                          
                                            <apex:column value="{!pbtObj[pageSection['acfComm__Related_List_Privacy_API__c']]}"
                                                rendered="{!pageSection['acfComm__Related_List_Privacy_API__c']!=null}">
                                                <apex:facet name="header">Private</apex:facet>
                                            </apex:column>
                                            <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}"
                                                var="objField">
                                                <apex:column rendered="{!objField.acfComm__Read_Mode__c==true}" >
<!--                                                     <apex:inputField value="{!pbtObj[objField.acfComm__Field_API_Name__c]}" rendered="{!mapEditableFields[pbtObj['Id']]}"/> -->
                                                    <apex:outputField value="{!pbtObj[objField.acfComm__Field_API_Name__c]}" />
                                                    <apex:facet name="header">{!objField.acfComm__Field_Name__c}</apex:facet>
                                                </apex:column>
                                            </apex:repeat>
                                        </apex:pageBlockTable>
                                         
                                        <!--update  layout -->
                                        <apex:outputPanel id="showPanel" rendered="{!show}">
                                          <div class="profile_fullEdit">
                                                <div class="ps_addNew">Update New</div>
<!--                                                <apex:variable value="{!sectionIdToObjMap[pageSection['Id']]}" var="pbtObj1"> -->
                                                    <apex:repeat value="{!sectionIdToObjMap[pageSection['Id']]}" var="pbtObj">
                                                        <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}" var="objField" rendered="{!pbtObj['Id'] == realtedListEditObjId}">
                                                             <apex:outputPanel rendered="{!objField.acfComm__Edit_Mode__c==true}">
                                                                 <div class="ps_fields">
                                                                    <div class="ps_label">
                                                                        <apex:outputlabel >{!objField.acfComm__Field_Name__c}</apex:outputlabel>
                                                                    </div>
                                                                    <div class="ps_data ps_edit">
                                                                          <div class="relatedAnchorTag">
                                                                                      <apex:inputField required="false" value="{!pbtObj[objField.acfComm__Field_API_Name__c]}" rendered="{!pbtObj['Id'] == realtedListEditObjId}" styleClass="achorTagClass"/>
                                                                           </div>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:repeat>
                                                            <apex:commandButton value="Update" rerender="frmSubsection" styleClass="buttonClass updateBtnRelatedFull" onclick="validateIsBlankFullUpdate('{!pbtObj.id}')"  rendered="{!pbtObj['Id']== realtedListEditObjId}" />
                                                            <!--<apex:commandButton value="Update" rerender="frmSubsection,showPanel" action="{!UpdateRelatedFullRecord}" styleClass="buttonClass"  rendered="{!pbtObj['Id']== realtedListEditObjId}">
                                                                <apex:param name="relFullId" value="{!pbtObj.id}" assignTo="{!relatedFullId}" />
                                                            </apex:commandButton>-->
                                                    </apex:repeat>
                                        
                                             <!--     <apex:commandButton value="Update" rerender="frmSubsection" action="{!UpdateRelatedFullRecord}" styleClass="buttonClass" rendered="{!pbtObj['Id'] == realtedListEditObjId}">
                                                         <apex:param name="relFullId" value="{!pbtObj1['Id']}"  -->
<!--                                                              assignTo="{!relatedFullId}" /> 
                                                </apex:commandButton>-->
<!--                                                </apex:variable> -->
                                            </div>
                                        </apex:outputPanel>
                                         
<!--                                             <apex:outputPanel rendered="{!hide}"> -->
                                                 <apex:outputPanel rendered="{!!show}">
                                                    <apex:outputPanel rendered="{!pageSection['acfComm__Read_Only__c']==false && pageSection['acfComm__Create__c']==true}" >
                                                        <div class="profile_fullEdit">
                                                                <div class="ps_addNew">Add New</div>
                                                                <apex:outputPanel rendered="{!pageSection['acfComm__Related_List_Privacy_API__c']!=null}">
                                                                     <div class="ps_fields">
                                                                             <div class="ps_label">
                                                                                         <apex:outputLabel value="Private" />
                                                                              </div>
                                                                            <div class="ps_data ps_edit">
                                                                                    <apex:inputField value="{!sectionIdToRelatedListObjectMap[pageSection['Id']][pageSection['acfComm__Related_List_Privacy_API__c']]}"/>
                                                                            </div>
                                                                    </div>
                                                                </apex:outputPanel>
                                                                
                                                                <apex:repeat value="{!sectionIdToFieldsMap[pageSection['Id']]}" var="objField">
                                                                    <apex:outputPanel rendered="{!objField.acfComm__Edit_Mode__c==true}">
                                                                        <div class="ps_fields">
                                                                                <div class="ps_label">
                                                                                    <apex:outputLabel value="{!objField.acfComm__Field_Name__c}" />
                                                                                </div>
                                                                                <div class="ps_data ps_edit">
                                                                                        <div class="achorTagClass">
                                                                                            <apex:inputField required="false" value="{!sectionIdToRelatedListObjectMap[pageSection['Id']][objField.acfComm__Field_API_Name__c]}" styleClass="tobeCheckd1" id="btnAddProfile" />
                                                                                            <!--<apex:inputfield value="{!sectionIdToRelatedListObjectMap[pageSection['Id']][objField.acfComm__Privacy_Field_API__c]}" label="" rendered="{!objField.acfComm__Privacy_Field_API__c!=null}"/>-->
                                                                                         </div>
                                                                                 </div>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </apex:repeat>
                              
                                                                <div class="clr">&nbsp;</div>
                                                                  <apex:outputpanel styleClass="error" style="color: #8f4b42;">At least one field must have a value</apex:outputpanel><br/><br/>
                                                                  <button  class="buttonClass" type="button"  onclick="validateIsBlankFull1(this, '{!pageSection['Id']}')">Add</button>
                                                             </div>
                                                             
                                                    </apex:outputPanel>
                                        </apex:outputPanel>
                                   </apex:outputPanel>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:pageBlock>
                </apex:repeat>
                </apex:outputPanel>
                
                <apex:outputPanel id="lowerButtonPanel" >
                    <div class="profile_buttons" style="margin-top: 14px;">
                        <apex:outPutPanel id="editPanel1" rendered="{!showEditBtn}">
                            <apex:commandButton id="cbEdit1" value="Edit"
                                rerender="pageBody, editPanel, editPanel2, lowerButtonPanel, upperButtonPanel"
                                action="{!EditSobjectRecord}" rendered="{!!isEditMode}" immediate="true"/>
                            <apex:commandButton id="cbSave1" value="Save"
                                rerender="pageBody, editPanel, editPanel2, lowerButtonPanel, upperButtonPanel"
                                onclick="confirm('{!show}','{!!isDisplayAdd}');" rendered="{!isEditMode}" />
                            <apex:commandButton id="cbCancel1" value="Cancel"
                                reRender="pageBody, editPanel, editPanel2, lowerButtonPanel, upperButtonPanel"
                                action="{!cancel}" rendered="{!isEditMode }"/>
                        </apex:outPutPanel>
                    </div>
                </apex:outputPanel>
        </div>
 <apex:actionFunction action="{!saveSobjectRecordToList}" name="saveSobjectRecordToList" reRender="frmSubsection" > 
       <apex:param name="pageSectionId" value="" assignTo="{!pageSectionId}" />  
<!--                                 value="{!pageSection['Id']} -->
 </apex:actionFunction> 
 <apex:actionFunction action="{!UpdateRelatedFullRecord}" name="UpdateRelatedFullRecord" reRender="frmSubsection" > 
       <apex:param name="relFullId" value="" assignTo="{!relatedFullId}" />
 </apex:actionFunction> 
  <apex:actionFunction action="{!UpdateRelatedCompactRecord}" name="UpdateRelatedCompactRecord"> 
<!--        <apex:param name="realtedListEditObjId" value="" assignTo="{!realtedListEditObjId}" /> -->
 </apex:actionFunction> 
 

<apex:actionFunction name="saveSobjectRecord" action="{!saveSobjectRecord}"/>
<apex:actionFunction name="methodOneInJavascript" rerender="tstpopup"/>

        <div id="tstpopup">
        <div id="div1" class="popupBackground" style="display:none;"/>
            <div id="div2" class="custPopup" style="display:none;">
           <b>You have an unsaved Update and if you continue you will lose your update.</b>
                <div class="close-popup">
                    <apex:commandButton value="Ok" action="{!saveSobjectRecord}" status="theActionStatus" styleClass="buttonClass"/>
                     <apex:commandButton value="Cancel" action="{!editRelatedListCompact}" status="theActionStatus" styleClass="buttonClass"/>
                 </div>
            </div>
        </div>

                                                           
 </apex:form>
    </apex:outputPanel>
    <script src="https://code.jquery.com/jquery-2.1.4.js" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>
    function validateIsBlankCompactUpdate(el, param_compact)
    {
        var isEmpty = 0;
        $(el).parent().parent().parent().children().children(':text, select').each(function( index, element ) 
        { 
            if($(element).val()=='')
            {
                isEmpty++;
            } 
        });

        if(isEmpty == $(el).parent().parent().parent().children().children(':text, select').length)
        {
            alert('At least one field must have a value!');
        }
        else
        {
            UpdateRelatedFullRecord(param_compact);
        }

    }

    function validateIsBlankCompact1(el, param_compact)
    {
        /*var isEmpty = 0;
        $(el).parent().parent().children().children(':text, select').each(function( index, element ) 
        { 
            if($(element).val()=='')
            {
                isEmpty++;
            } 
        });

        if(isEmpty == $(el).parent().parent().children().children(':text, select').length)
        {
            alert('At least one field must have a value!');
        }
        else
        {*/
            saveSobjectRecordToList(param_compact);
        //}
    }

    function confirm(showValue,showUpdate) {
        if(showValue == 'true' || showUpdate == 'true') {
            $("#div1").css("display","block");
            $("#div2").css("display","block");
            methodOneInJavascript();
        } else {
        saveSobjectRecord();
        }
    }
    
    
    function validateIsBlankFullUpdate(param_compact)
    {
       
       checkCliked = 1;
        var isEmpty = 0;
        $('.updateBtnRelatedFull').parent().children().children().children('.ps_data').children().children(':text, select').each(function( index, element ) 
        { 
            if($(element).val()=='')
            {
                isEmpty++;
            } 
        });

        if(isEmpty == $('.updateBtnRelatedFull').parent().children().children().children('.ps_data').children().children(':text, select').length)
        {
            alert('At least one field must have a value!');
        }
        else
        {
            UpdateRelatedFullRecord(param_compact);
        }
    }
    
    function validateIsBlankFullUpdateCompact()
    {
       
       /*checkCliked = 1;
        var isEmpty = 0;
        $('.updateBtnRelatedFull').parent().children().children('.ps_data').children().children(':text, select').each(function( index, element ) 
        { 
            if($(element).val()=='')
            {
                isEmpty++;
            } 
        });

        if(isEmpty == $('.updateBtnRelatedFull').parent().children().children('.ps_data').children().children(':text, select').length)
        {
            alert('At least one field must have a value!');
        }
        else
        {
            UpdateRelatedFullRecord(param_compact);
        }*/
        UpdateRelatedCompactRecord();
    }

    function validateIsBlankFull1(el, param_compact)
    {
        var isEmpty = 0;
        $(el).parent().children().children().children('.ps_data').children().children(':text, select').each(function( index, element ) 
        { 
            if($(element).val()=='')
            {
                isEmpty++;
            } 
        });

        if(isEmpty == $(el).parent().children().children().children('.ps_data').children().children(':text, select').length)
        {
            alert('At least one field must have a value!');
        }
        else
        {
            saveSobjectRecordToList(param_compact);
        }
    }

    /*function validateIsBlankCompact(param_compact) 
    {
    var textFields = $('.tobeCheckd').find('input[type=text]');
     var isEmpty = 0;
     for(i = 0; i < textFields['prevObject'].length ; i++){
         var inputField = textFields['prevObject'][i];
         if(String(inputField.value) == '' && (String(inputField.type) =='text')){
                 isEmpty++;
         }
     }
       if(isEmpty == textFields['prevObject'].length - 1){
                $(".error").removeClass("error");
            }
       else{
                saveSobjectRecordToList(param_compact);
       }
    }*/

     /*function validateIsBlankFull(param_full) {
     var elements = $(".tobeCheckd1");
     var emptyCount = 0;
     for(i =0 ;i < elements.length; i++){
        if(elements[i].value == ''){
         emptyCount++;
        }
     }
         if (emptyCount == elements.length) {
              $(".error").removeClass("error");
        }
        else {
            saveSobjectRecordToList(param_full);
        }
    }*/
    
         $(document).ready(function() {
          //Sophak Added for Mobile resposive.   
        if (navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i) != null) {
      //     alert("mobile insertface");
           setMobile();
          //  mobile = true;
        } else {
      //      alert("desktop interface");
          setDesktop();
          //  mobile = false;
        }
        
        //checkContactId();
        //console.log('checkContactId***');
        //var contactId = '{!currentUserContactId}';
        //if(contactId == null){
           // location.href='/apex/BlankPage';
        //}
    });
//     function updateContactRecord(relatedListId){
//         alert(relatedListId);
//         updateUserRecord(relatedListId);
//         alert("After..");
//         //return false;
//     }
    
    function fnRemoveMobileCardMask(sVFpageTitle) {
        var aMasks = top.document.getElementsByClassName('mask');

        for ( var i = 0; i < aMasks.length; i++) {
            if (aMasks[i].title == sVFpageTitle) {
                aMasks[i].style.display = 'none';
                comm_pre = window.location.toString()
                        .match(/\/[a-zA-Z]+\//);
                comm_id = window.location.toString().match(
                        /\id=[a-zA-Z0-9]+\&/);
                window.onload = function() {
                    abutton = document
                            .getElementsByClassName('profile_buttons');
                    elnew = '<input value="View More" type="button" onclick="javascript:sforce.one.navigateToURL(\''
                            + comm_pre
                            + 'apex/'
                            + sVFpageTitle
                            + '?'
                            + comm_id + '\');" />';
                    abutton[0].innerHTML = elnew;
                }

            }
        }
    }

       fnRemoveMobileCardMask("Profile_Personal_V1_Clone1");
       
       
   </script>
</apex:page>